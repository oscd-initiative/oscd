<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OSCD: Sprint #2 Main</title>
    <link rel="stylesheet" href="../hack_black.css">
    <link rel="apple-touch-icon" sizes="57x57" href="../img/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../img/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../img/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../img/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../img/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../img/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../img/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../img/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../img/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="../img/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../img/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../img/favicon-16x16.png">
    <link rel="manifest" href="../img/manifest.json">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="msapplication-TileImage" content="../img/ms-icon-144x144.png">
    <meta name="theme-color" content="#000000">
  </head>
  <body class="hack">
    <div class="main container">
      <br>
      <center> <a href="../index.html">Home</a> </center>
      <br>
      <center> <a href="sprint_2.html">EN</a> | <a href="sprint_2_ru.html">RU</a> </center>
      <div>
      <p align="center">
        <img src="../img/oscd_logo_v2.gif" alt="OSCD">
      </p>
      </div>
      <center> <p style="font-size: 16px;">OSCD Sprint #2: Simulation, Detection & Response</p> </center>
      <br>
      It's been a while since <a href="sprint_1.html" target="_blank">the First OSCD Sprint</a>, dedicated to Threat Detection. This time we will focus on multiple areas of practical CyberSecurity. You can find a detailed backlog <a href="sprint_2_backlog.html" target="_blank">here</a>. Below is a general description of the sprint and areas of work.
      <br><br><br>
      <h2>Goals</h2>
      - Improve <a href="https://attack.mitre.org" target="_blank">MITRE ATT&CK</a> coverage of open source <a href="https://github.com/Neo23x0/sigma/" target="_blank">Sigma</a> rules and <a href="https://github.com/redcanaryco/atomic-red-team" target="_blank">Atomic Red Team</a> tests<br>
      - Improve cross-coverage of <a href="https://github.com/Neo23x0/sigma/" target="_blank">Sigma</a> rules and <a href="https://github.com/redcanaryco/atomic-red-team" target="_blank">Atomic Red Team</a> tests<br>
      - Improve <a href="https://atc-project.github.io/atc-react/" target="_blank">ATC RE&CT</a> coverage of open source <a href="https://thehive-project.org/#section_cortex" target="_blank">TheHive Responders</a><br>
      <br><br>
      <h2>The plan</h2>
      1. Two weeks-long sprint starts October 5, 2020<br>
      2. Participants pick up tasks from the <a href="sprint_2_backlog.html" target="_blank">backlog</a> or contribute other analytics<br>
      3. Participants use special <a href="sprint_2_howto.html" target="_blank">guideline</a> which will help to get familiar with the workflow<br>
      4. Results will be collected, reviewed, and pushed to projects' repositories on GitHub<br>
      <br><br>
      <h2>Threat Detection</h2>
      There is the <a href="https://github.com/Neo23x0/sigma/">Sigma project</a> — Generic Signature Format for SIEM Systems. 
      It has a converter that generates searches/queries for different SIEM systems and a set of Detection Rules. 
      <br><br>
      With time, the Sigma project ruleset has become the biggest (more than 600 rules) and the most mature community-driven Detection Rules set. This is the place where you could find Detection Rules for emerging threats (i.e. <a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_exploit_cve_2020_1350.yml">Windows DNS Server RCE CVE-2020-1350</a> exploit), adversary simulations tools (<a href="https://github.com/Neo23x0/sigma/search?q=empire&unscoped_q=empire">Empire</a>, <a href="https://github.com/Neo23x0/sigma/search?q=cobalt+strike&unscoped_q=cobalt+strike">Cobalt Strike</a>), adversary behaviors (<a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_kernel_and_3rd_party_drivers_exploits_token_stealing.yml">Token stealing</a>), and many more. Most of the rules are mapped to the <a href="https://attack.mitre.org/">MITRE ATT&CK</a> framework.
      <br><br>
      Even if you are not using Sigma converter, you still can benefit from its ruleset. Most of the advanced security teams are subscribed to the Sigma Project updates on <a href="https://github.com/Neo23x0/sigma/">GitHub</a>. It's a good time to do so if you haven't yet.
      <br><br>
      There are some critical gaps in the Sigma ruleset and plenty of decent publicly available Threat Detection analytics that haven't been added to the ruleset yet. That's what we decided to focus on. A detailed backlog on Threat Detection could be found <a href="sprint_2_backlog.html" target="_blank">here</a>.
      <br><br><br>
      <h2>Adversary Simulation</h2>
      There is the <a href="https://github.com/redcanaryco/atomic-red-team">Atomic Red Team project</a> — small and highly portable detection tests based on MITRE's ATT&CK. It allows every security team to test their controls by executing simple "atomic tests" that exercise the same techniques used by adversaries.
      <br><br>
      With time, Atomic Red Team tests set has become the biggest and the most mature community-driven Adversary Simulation tests set.
      <br><br>
      There are atomic tests that are not covered by Sigma detection rules. This means that the community has a way to automatically simulate adversarial techniques but no rules to detect them in the public repository of the Sigma project.
      <br><br>
      At the same time, there are Sigma rules that are not covered by Atomic Red Team tests. In other words, the community has a way to detect adversarial techniques but no tests to simulate them in the public repository of the Atomic Red Team project.
      <br><br>
      Here is the actual Atomic Red Team and Sigma projects' coverage of the <a href="https://attack.mitre.org/">ATT&CK</a> framework. Techniques that are covered by Sigma rules highlighted in blue color, Atomic Red Team tests - in red, both - in purple (click to expand):
      <br><br>
      <details>
        <summary> Microsoft Windows</summary>
        <pre><iframe src="https://mitre-attack.github.io/attack-navigator/enterprise/#layerURL=https%3A%2F%2Fraw.githubusercontent.com%2Fzinint%2FOSCD_Sigma-ART_Layers%2Fmaster%2Fsigma-art-navigator-layer-windows.json" width="700" height="500"></iframe></pre>
      </details>
      <details>
        <summary> Apple macOS</summary>
        <pre><iframe src="https://mitre-attack.github.io/attack-navigator/enterprise/#layerURL=https%3A%2F%2Fraw.githubusercontent.com%2Fzinint%2FOSCD_Sigma-ART_Layers%2Fmaster%2Fart-navigator-layer-macos.json" width="700" height="500"></iframe></pre>
      </details>
      <details>
        <summary> GNU/Linux</summary>
        <pre><iframe src="https://mitre-attack.github.io/attack-navigator/enterprise/#layerURL=https%3A%2F%2Fraw.githubusercontent.com%2Fzinint%2FOSCD_Sigma-ART_Layers%2Fmaster%2Fsigma-art-navigator-layer-linux.json" width="700" height="500"></iframe></pre>
      </details>
      <br>
      That's what we decided to focus on. A detailed backlog on Adversary Simulation could be found <a href="sprint_2_backlog_ru.html" target="_blank">here</a>.
      <br><br><br>
      <h2>Incident Response</h2>
      There is the <a href="https://thehive-project.org/#section_thehive" target="_blank">TheHive</a> — the most powerful open source and free Security Incident Response Platform.
      It has a module called <a href="https://thehive-project.org/#section_cortex" target="_blank">Cortex</a> — Observable Analysis and Active Response Engine. 
      It operates by two key entities, called <b>Analyzers</b> and <b>Responders</b> — simple Python scripts that utilize API to communicate with 3rd party systems and execute some actions:
      <br><br>
      - <b>Analyzers</b> provide the ability to analyze observables (i.e. IP address, Domain name, File hash etc) via Cyber Threat Intelligence platforms (i.e. <a href="https://www.misp-project.org/" target="_blank">MISP</a>), analysis systems (i.e. <a href="https://cuckoosandbox.org/" target="_blank">Cuckoo Sandbox</a>) and lookup services (i.e. <a href="https://www.virustotal.com/gui/home/upload" target="_blank">VirusTotal</a>)
      <br><br>
      - <b>Responders</b> provide the ability to execute some Response Actions (i.e. block domain name on a DNS server, block IP address on a firewall etc) by executing these actions with Python scripts
      <br><br>
      With time, the community developed about 150 Analyzers, which provide the ability to automatically analyze most of the observables types by most of the existing platforms, systems, and services.
      <br><br>
      For some reason, it didn't happen the same way with the Responders — there are only 20 of them, and they are far away from covering most common cases with common systems.
      <br><br>
      Here is the actual TheHive Analyzers and Responders coverage of the <a href="https://atc-project.github.io/atc-react/" target="_blank">RE&CT</a> framework. Analyzers are belonged to the <a href="https://atc-project.github.io/atc-react/Response_Stages/RS0002/" target="_blank">Identification</a> stage, while Responders are mostly to the <a href="https://atc-project.github.io/atc-react/Response_Stages/RS0003/" target="_blank">Containment</a>, <a href="https://atc-project.github.io/atc-react/Response_Stages/RS0004/" target="_blank">Eradication</a>, and <a href="https://atc-project.github.io/atc-react/Response_Stages/RS0005/" target="_blank">Recovery</a> stages:
      <br><br>
      <details>
        <summary> Current coverage is green, possible is yellow (click to expand)</summary>
        <pre><iframe src="https://oscd-initiative.github.io/react-navigator/" width="700" height="500"></iframe></pre>
      </details>
      <br>
      <!-- The coverage was built upon <a href="https://github.com/oscd-initiative/Cortex-Analyzers" target="_blank">our fork</a> of repo with TheHive Analyzers and Responders, that we tagged with RE&CT IDs. -->
      That's why we've decided to focus on the TheHive Responders development this time. A detailed backlog on Incident Response could be found <a href="sprint_2_backlog.html" target="_blank">here</a>.
      <br><br>
      <h2>Results</h2>
      - 242 new <a href="https://github.com/SigmaHQ/sigma/pull/1362">Sigma</a> rules added and 305 updated; <br>
      - 23 new <a href="https://github.com/redcanaryco/atomic-red-team/pull/1431"> Atomic Red Team</a> tests and 3 new artifacts added, and 7 tests updated; <br>
      - 24 new <a href="https://github.com/TheHive-Project/Cortex-Analyzers/pull/991">The Hive</a> responders, including Palo Alto NGFW, Duo Security, Gmail and Azure Active Directory. <br>
      <br><br><br>
      <center> <a href="sprint_2.html">EN</a> | <a href="sprint_2_ru.html">RU</a> </center>
      <br>
      <center> <a href="../index.html">Home</a> </center>
      <br>
  </div>
 </body>
</html>
